# 自由训练统计规范（最终版）

## 0. 会话与数据定义

自由训练 session 从用户主动开始到主动退出结束，获得连续力量时间序列
[
F(t),\quad t\in[0,T)
]

不区分准备阶段与持续阶段，不切分循环。

采样间隔
[
\Delta t = 0.05\ \text{s}
]

必须保存的基础信息：

* 开始时间戳、结束时间戳
* 总时长 (T)
* (\Delta t)
* 规则版本号

---

## 1. 非重叠 1 s 窗口划分

窗口长度固定为
[
W = 1.0\ \text{s}
]

窗口数量
[
K = \left\lfloor \frac{T}{W} \right\rfloor
]

第 (k) 个窗口定义为
[
I_k = [kW,(k+1)W),\quad k=0,1,\dots,K-1
]

仅使用完整窗口 (I_0\sim I_{K-1})。尾部不足 1 s 的数据不参与统计。

窗口平均力量定义为
[
\mu_k = \mathrm{mean}\big(F(t)\ \text{for}\ t\in I_k\big)
]

---

## 2. 最大控制力量与控制时间

### 2.1 鲁棒最大力量

为避免瞬时尖峰影响，定义鲁棒最大力量为
[
M = \mathrm{quantile}(F(t), 0.99),\quad t\in[0,T)
]

---

### 2.2 最大控制力量

沿用计时训练的定义，控制区间为
[
C = {t\in[0,T): F(t)\ge 0.95M}
]

最大控制力量定义为控制区间内力量的中位数
[
F_{ctrl} = \mathrm{median}_{t\in C}(F(t))
]

缺失规则：若 (C) 为空，则 (F_{ctrl}) 记为缺失，并保存缺失标志。

---

### 2.3 控制时间

定义可接受下限（只限制下界，允许超过）：
[
\phi = 0.95F_{ctrl}
]

控制时间定义为
[
T_{ctrl} = \int_{0}^{T} \mathbf{1}\big(F(t)\ge \phi\big),dt
]

建议同时输出控制时间占比
[
R_{ctrl} = \frac{T_{ctrl}}{T}
]

缺失规则：若 (F_{ctrl}) 缺失，则 (T_{ctrl}) 与 (R_{ctrl}) 记为缺失。

---

## 3. 区间平均力量（1 s）

区间平均力量即非重叠 1 s 窗口均值序列 ({\mu_k})。

结算页建议至少输出以下摘要统计：
[
\mu_{\max} = \max_k \mu_k
]
[
\mu_{\mathrm{median}} = \mathrm{median}*k \mu_k
]
[
\mu*{\min} = \min_k \mu_k
]

同时保存完整序列 ({\mu_k})，用于趋势图与训练复盘。

---

## 4. 区间力量变化（1 s，百分比，区分正负）

### 4.1 固定分母保护常量

为避免低力区间导致百分比爆炸，定义固定保护常量
[
\epsilon = \epsilon_0
]

**规范要求**：
(\epsilon_0) 为一个固定的、与设备单位一致的绝对力值常量，写死在规则版本中，用于所有 session。
其含义是“变化百分比计算中允许的最小参考力量”。

（例如：(\epsilon_0) 取明显高于传感器噪声、但远低于正常发力区间的量级。）

---

### 4.2 区间力量变化定义

对相邻窗口，定义带符号的百分比变化：
[
\Delta_k(%) = 100 \cdot \frac{\mu_k - \mu_{k-1}}{\max(\mu_{k-1},\epsilon_0)},\quad k=1,\dots,K-1
]

符号约定：

* (\Delta_k > 0)：力量上升
* (\Delta_k < 0)：力量下降

---

### 4.3 区间变化的结算页统计

建议输出并保存以下摘要指标：
[
\Delta^{+}*{\max} = \max_k \Delta_k
]
[
\Delta^{-}*{\min} = \min_k \Delta_k
]
[
\Delta_{\mathrm{median}} = \mathrm{median}_k \Delta_k
]

同时保存完整序列 ({\Delta_k})，用于分析节奏、爆发与衰减。

---

## 5. 保存字段清单（自由训练）

### 基础

* 开始时间戳、结束时间戳
* (T, \Delta t, W=1\ \text{s}, K)
* 规则版本号

### 力量与控制

* (M)
* (F_{ctrl})（含缺失标志）
* (T_{ctrl}, R_{ctrl})

### 区间统计

* ({\mu_k})
* ({\Delta_k})

### 固定常量

* 0.99 分位数
* 0.95 控制门槛
* (\epsilon_0)（固定值）

---

## 6. 与计时训练的一致性说明

* 自由训练与计时训练**共用同一“最大控制力量”与“控制时间”语义**
* 自由训练不定义力竭、不定义持续阶段、不定义循环
* 1 s 非重叠窗口是自由训练中唯一的时间结构单位

---

## 7. 设计边界说明（很重要）

* 自由训练指标**用于描述状态与节奏**，不用于判定能力极限
* 最大力量与力竭类判断只应出现在计时训练中
* (\Delta_k) 反映的是“输出变化速率”，而非疲劳或控制失败
